\errorcontextlines 10000
\documentclass[a4paper,12pt]{memoir}
\usepackage{etoolbox}
% for flexible tables
\usepackage{tabularx}
\usepackage{ltablex}
% set up fonts
\usepackage{fontspec}
\setsansfont{Titillium-Regular}
\setmainfont{Titillium-Regular}
\setromanfont{FSSinclair-Medium}

% smaller margins
\usepackage[margin=1cm]{geometry}

% customise sections
% need explicit to access parameter number to get the section on the left
\usepackage[explicit]{titlesec}
\titleformat{\section}[hang]{\rmfamily\uppercase}{\thesection.}{0em}{ #1\hrulefill}
% drawing packages
\usepackage{tikz}
\usetikzlibrary{shapes}
\usetikzlibrary{decorations.text}
\usepackage{pgfplots}
\pgfplotsset{
  compat = newest,
  tick label style = {font=\sffamily},
  every axis label = {font=\sffamily},
  legend style = {font=\sffamily\small, draw=none},
  y axis line style = {draw=none},
  label style = {font=\sffamily}
}

% custom colours
\definecolor{adaYellow}{RGB}{245,225,52}
\definecolor{adaPurple}{RGB}{149,96,159}
\definecolor{adaGreen}{RGB}{161,200,84}
\definecolor{adaCoral}{RGB}{236,98,113}
\definecolor{adaBlue}{RGB}{108,184,231}
\definecolor{adaOrange}{RGB}{246,131,82}

\definecolor{adaBlack}{RGB}{9,20,8}
\definecolor{adaGrey}{RGB}{134,136,140}
\definecolor{adaLightGrey}{RGB}{211,212,211}
\definecolor{adaWhite}{RGB}{255,255,255}

\definecolor{clr1}{RGB}{149,96,159}
\definecolor{clr2}{RGB}{161,200,84}
\definecolor{clr3}{RGB}{236,98,113}
\definecolor{clr4}{RGB}{108,184,231}
\definecolor{clr5}{RGB}{246,131,82}

% Declare layers
\pgfdeclarelayer{background}
\pgfsetlayers{background,main}

\setlength{\columnsep}{1em}
\renewcommand{\arraystretch}{1.2}

\begin{document}
% no page numbers
\pagestyle{empty}
% title
\begin{center}
    {\rmfamily\uppercase{
        {\large \VAR{name}}\\
        \VAR{date}\\
        Team \VAR{team}}}
\tikz[remember picture,overlay,shift=(current page.north east)] \node[inner sep=0pt] at (-2,-2) {\includegraphics[height=2cm]{NCDS.jpg}};
\end{center}
% Attendance bar chart
\section*{\VAR{attendance_cumulative}\% Attendance}
\begin{tikzpicture}[scale=1]
  \begin{axis}[
  width=10cm,
  height=5cm,
  ybar stacked,
  legend style={{at=(1.2,0.5)},anchor=west},
  legend cell align={left},
  axis y line*=left,
  axis x line*=bottom,
  symbolic x coords={0,\VAR{attendance_dates},1},
  xtick ={\VAR{attendance_dates}},
  tick align=outside,
  x tick label style={rotate=90,anchor=east},
  y tick label style={anchor=east},
  ymin = 0,
  ymax = 100,
  ytick = {95, 100},
  yticklabels = {},
  xticklabels = {\VAR{attendance_dates}},
  xmin = 0,
  xmax = 1,
  ylabel = \% sessions attended,
  grid=major,
  clip=false,
  ]
  \addplot[adaBlue, bar width=14pt, fill=adaBlue] coordinates {\VAR{attendance_zip}};
  \addplot[adaPurple, bar width=14pt, fill=adaPurple] coordinates {\VAR{punctuality_zip}};
  \node at (axis cs:1,95) [anchor=west] {{\sffamily Target 95\%}};
  \legend{Present,Present but late}
\end{axis}
\end{tikzpicture}
% Academic
\section*{Academic}
{\sffamily
  \begin{tabularx}{\linewidth}{l l l X}
%% for subject, assessment in academic.items()
\multicolumn{4}{l}{\rmfamily \VAR{subject}}\\
%% for assessment_name, assessment_details in assessment.items()
& \VAR{assessment_name}& \VAR{assessment_details['grade']}& {\em \VAR{assessment_details['comment']}}\\
%% endfor
%% endfor
  \end{tabularx}
}
% Kudos
\section*{\VAR{kudos_total} Kudos}
{\sffamily
%% if kudos|length > 0
  \begin{tabularx}{\linewidth}{l l X}
%% for kudo in kudos
\VAR{kudo.date}& $\VAR{kudo.points}\times$ \VAR{kudo.ada_value} & {\em
                                                                  \VAR{kudo.description}}
                                                                  \mbox{-- \VAR{kudo.from}}\\
%% endfor
    \end{tabularx}
%% else
No kudos points recorded
%% endif
}
% Concern
\section*{\VAR{concern_total} Concerns}
{\sffamily
%% if concerns|length > 0
  \begin{tabularx}{\linewidth}{l l X}
%% for concern in concerns
\VAR{concern.date}& \VAR{concern.category} & {\em \VAR{concern.description}} -- \VAR{concern.from}\\
  %% endfor
    \end{tabularx}
  %% else

  No concerns recorded
  %% endif
  }
\section*{Coming up}
{\sffamily
\begin{tabularx}{\linewidth}{l l l X}
  30th Mar & & & Parents/carers consultation day \\
  31st Mar & & & Last day of Spring term \\
  19th Apr & & & First day of Summer term \\
  28th May & & & Internal assessment grades submitted \\
  31st May & -- & 4th Jun & Half term holiday \\
  18th Jun & & & Teacher assessed grades submitted to exam boards \\
           & & & Last day of academic year \\
  23rd Jun & -- & 25th Jun & End of year show \\
  25th Jun & & & Graduation celebration
\end{tabularx}
}
\end{document}
